/*! qunit-image v0.0.1 MathLib.de | MathLib.de/en/license */
QUnit.extend(QUnit.assert,{imageEqual:function(t,e,n){n=n||{};var a,i,r,l,s,o,u,c,g,d,p,_,m,h,f,y,b,v,x=document.createElement("canvas"),w=document.createElement("canvas"),q=document.createElement("canvas"),E=0,C=0,j=!1,A=!0,P=n.width||300,I=n.height||300,T=80,L=510/T;window.qunitImage=window.qunitImage||{tests:[],id:0},g=function(){for(o=s.getImageData(0,0,P,I).data,r=i.getImageData(0,0,P,I).data,q.height=I,q.width=P,u=q.getContext("2d"),c=u.getImageData(0,0,P,I),p=0,_=4*P*I;_>p;p+=4)m=Math.abs(o[p]-r[p]),h=Math.abs(o[p+1]-r[p+1]),f=Math.abs(o[p+2]-r[p+2]),y=Math.abs(o[p+3]-r[p+3]),v=m+h+f+y,C+=v,E+=!!m+!!h+!!f+!!y,b=L*Math.min(T,v),c.data[p]=Math.min(255,b),c.data[p+1]=Math.min(255,510-b),c.data[p+2]=0,c.data[p+3]=255;u.putImageData(c,0,0),"imageDistance"in n||"channelErrors"in n?("imageDistance"in n&&(A=A&&4*P*I*n.imageDistance>C),"channelErrors"in n&&(A=A&&4*P*I*n.channelErrors>E)):A=.5*4*P*I>C,d=JST["src/qunit-image.hbs"]({id:window.qunitImage.id,width:P,height:I,channelErrors:E,imageDistance:C,actCanvas:x.toDataURL(),expCanvas:w.toDataURL(),diffCanvas:q.toDataURL()}),window.qunitImage.tests.push({id:window.qunitImage.id,width:P,height:I,channelErrors:E,imageDistance:C,actual:{canvas:x,ctx:i,data:r},expected:{canvas:w,ctx:s,data:o},diffCanvas:{canvas:q,ctx:u,data:c}}),window.qunitImage.id++,QUnit.config.current.assertions.push({result:A,message:d})},"string"==typeof t?(a=new Image,a.onload=function(){x.height=I,x.width=P,i=x.getContext("2d"),i.drawImage(a,0,0),j?(0!==QUnit.config.semaphore&&QUnit.start(),g()):j=!0},a.src=t):(x=t,i=x.getContext("2d"),j?(0!==QUnit.config.semaphore&&QUnit.start(),g()):j=!0),"string"==typeof e?(l=new Image,l.onload=function(){w.height=I,w.width=P,s=w.getContext("2d"),s.drawImage(l,0,0),j?(0!==QUnit.config.semaphore&&QUnit.start(),g()):j=!0},l.src=e):(w=e,s=w.getContext("2d"),j?(0!==QUnit.config.semaphore&&QUnit.start(),g()):j=!0)}}),QUnit.done(function(){Array.prototype.forEach.call(document.getElementsByClassName("qunit-image-select"),function(t){t.addEventListener("change",function(t){var e=t.target.parentElement.nextElementSibling;e.getElementsByClassName("qunit-image-isVisible")[0].classList.remove("qunit-image-isVisible"),e.children[t.target.value].classList.add("qunit-image-isVisible")})}),Array.prototype.forEach.call(document.getElementsByClassName("qunit-image-range-clip"),function(t){t.addEventListener("input",function(t){t.target.nextElementSibling.children[0].style.setProperty("clip","rect(0px, 300px, 300px, "+t.target.value+"px)"),t.target.nextElementSibling.children[1].style.setProperty("clip","rect(0px, "+t.target.value+"px, 300px, 0px)")})}),Array.prototype.forEach.call(document.getElementsByClassName("qunit-image-range-opacity"),function(t){t.addEventListener("input",function(t){t.target.nextElementSibling.children[0].style.setProperty("opacity",1-t.target.value),t.target.nextElementSibling.children[1].style.setProperty("opacity",t.target.value)})}),Array.prototype.forEach.call(document.getElementsByClassName("qunit-image-img"),function(t){t.addEventListener("mouseover",function(t){var e=t.target.getAttribute("data-id"),n=document.getElementById("qunit-image-pixelComparison-"+e);n.children[0].style.setProperty("display","none"),n.children[1].style.setProperty("display","block")},!1)}),Array.prototype.forEach.call(document.getElementsByClassName("qunit-image-img"),function(t){t.addEventListener("mouseout",function(t){var e=t.target.getAttribute("data-id"),n=document.getElementById("qunit-image-pixelComparison-"+e);n.children[0].style.setProperty("display","block"),n.children[1].style.setProperty("display","none")},!1)}),Array.prototype.forEach.call(document.getElementsByClassName("qunit-image-img"),function(t){t.addEventListener("mousemove",function(t){var e=t.target.getAttribute("data-id"),n=document.getElementById("qunit-image-pixelComparison-"+e),a=window.qunitImage.tests[e],i="offsetX"in t?t.offsetX:t.layerX,r="offsetY"in t?t.offsetY:t.layerY,l=a.actual.ctx.getImageData(i,r,1,1).data,s=a.expected.ctx.getImageData(i,r,1,1).data;n.getElementsByClassName("qunit-image-xCoordinate")[0].innerHTML=i,n.getElementsByClassName("qunit-image-yCoordinate")[0].innerHTML=r,n.getElementsByClassName("qunit-image-table-rAct")[0].innerHTML=l[0],n.getElementsByClassName("qunit-image-table-gAct")[0].innerHTML=l[1],n.getElementsByClassName("qunit-image-table-bAct")[0].innerHTML=l[2],n.getElementsByClassName("qunit-image-table-aAct")[0].innerHTML=l[3],n.getElementsByClassName("qunit-image-table-rExp")[0].innerHTML=s[0],n.getElementsByClassName("qunit-image-table-gExp")[0].innerHTML=s[1],n.getElementsByClassName("qunit-image-table-bExp")[0].innerHTML=s[2],n.getElementsByClassName("qunit-image-table-aExp")[0].innerHTML=s[3],n.getElementsByClassName("qunit-image-table-act")[0].style.setProperty("background","rgba("+l[0]+","+l[1]+","+l[2]+","+l[3]+")"),n.getElementsByClassName("qunit-image-table-exp")[0].style.setProperty("background","rgba("+s[0]+","+s[1]+","+s[2]+","+s[3]+")")},!1)})}),this.JST=this.JST||{},this.JST["src/qunit-image.hbs"]=function(obj){obj||(obj={});var __t,__p="";with(_.escape,obj)__p+='<div class="qunit-image-wrapper">\n	<div>\n		Testing a '+(null==(__t=width)?"":__t)+"px by "+(null==(__t=height)?"":__t)+"px image ("+(null==(__t=height*width)?"":__t)+" total pixels, "+(null==(__t=4*width*height)?"":__t)+" channels).\n	</div>\n	<div>\n		There were errors on "+(null==(__t=channelErrors)?"":__t)+" channels ("+(null==(__t=(25*channelErrors/(width*height)).toFixed(3))?"":__t)+"%).\n	</div>\n	<div>\n		The very primitive accumulated rgba-distance of the images is "+(null==(__t=imageDistance)?"":__t)+'.\n	</div>\n	<div class="qunit-image-clearfix">\n		<div style="width:'+(null==(__t=width)?"":__t)+"px; height:"+(null==(__t=height)?"":__t)+'px;" class="qunit-image-figure">\n			<div class="qunit-image-figcaption">The actual image</div>\n			<img class="qunit-image-img" src="'+(null==(__t=actCanvas)?"":__t)+'" width="'+(null==(__t=width)?"":__t)+'px" height="'+(null==(__t=height)?"":__t)+'px" data-id="'+(null==(__t=id)?"":__t)+'"/>\n		</div>\n\n		<div style="width:'+(null==(__t=width)?"":__t)+"px; height:"+(null==(__t=height)?"":__t)+'px;" class="qunit-image-figure">\n			<div class="qunit-image-figcaption">The reference image</div>\n			<img class="qunit-image-img" src="'+(null==(__t=expCanvas)?"":__t)+'" width="'+(null==(__t=width)?"":__t)+'px" height="'+(null==(__t=height)?"":__t)+'px" data-id="'+(null==(__t=id)?"":__t)+'"/>\n		</div>\n\n		<div style="width:'+(null==(__t=width)?"":__t)+"px; height:"+(null==(__t=height)?"":__t)+'px;" class="qunit-image-figure">\n			<div class="qunit-image-figcaption">\n				<select class="qunit-image-select">\n					<option value="0">difference heatmap</option>\n					<option value="1">clip slider</option>\n					<option value="2">opacity slider</option>\n				</select>\n			</div>\n\n			<div>\n				<img src="'+(null==(__t=diffCanvas)?"":__t)+'" class="qunit-image-img qunit-image-comparisonImage qunit-image-isVisible" width="'+(null==(__t=width)?"":__t)+'px" height="'+(null==(__t=height)?"":__t)+'px" data-id="'+(null==(__t=id)?"":__t)+'"/>\n\n				<div class="qunit-image-comparisonImage">\n					<input type="range" min="0" max="'+(null==(__t=width)?"":__t)+'" class="qunit-image-range-clip" style="width:'+(null==(__t=width)?"":__t)+'px;">\n					<div class="qunit-image-absoluteContainer" style="width:'+(null==(__t=width)?"":__t)+"px; height:"+(null==(__t=height)?"":__t)+'px">\n						<img class="qunit-image-img" src="'+(null==(__t=actCanvas)?"":__t)+'" width="'+(null==(__t=width)?"":__t)+'px" height="'+(null==(__t=height)?"":__t)+'px"\n									style="clip: rect(0px, '+(null==(__t=width)?"":__t)+"px, "+(null==(__t=height)?"":__t)+"px, "+(null==(__t=width/2)?"":__t)+'px)" data-id="'+(null==(__t=id)?"":__t)+'"/>\n						<img class="qunit-image-img" src="'+(null==(__t=expCanvas)?"":__t)+'" width="'+(null==(__t=width)?"":__t)+'px" height="'+(null==(__t=height)?"":__t)+'px"\n									style="clip: rect(0px, '+(null==(__t=width/2)?"":__t)+"px, "+(null==(__t=height)?"":__t)+'px, 0px)" data-id="'+(null==(__t=id)?"":__t)+'"/>\n					</div>\n				</div>\n\n				<div class="qunit-image-comparisonImage">\n					<input type="range" min="0" max="1" step="0.01" class="qunit-image-range-opacity" style="width:'+(null==(__t=width)?"":__t)+'px;">\n					<div class="qunit-image-absoluteContainer" style="width:'+(null==(__t=width)?"":__t)+"px; height:"+(null==(__t=height)?"":__t)+'px">\n						<img class="qunit-image-img" src="'+(null==(__t=actCanvas)?"":__t)+'" width="'+(null==(__t=width)?"":__t)+'px" height="'+(null==(__t=height)?"":__t)+'px" style="opacity: 0.5" data-id="'+(null==(__t=id)?"":__t)+'"/>\n						<img class="qunit-image-img" src="'+(null==(__t=expCanvas)?"":__t)+'" width="'+(null==(__t=width)?"":__t)+'px" height="'+(null==(__t=height)?"":__t)+'px" style="opacity: 0.5" data-id="'+(null==(__t=id)?"":__t)+'"/>\n					</div>\n				</div>\n			</div>\n		</div>\n\n\n		<div id="qunit-image-pixelComparison-'+(null==(__t=id)?"":__t)+'" style="width:'+(null==(__t=width)?"":__t)+"px; height:"+(null==(__t=height)?"":__t)+'px;" class="qunit-image-figure">\n			<div>\n				Hover one of the images to get a pixel comparison.\n			</div>\n			<div style="display: none">\n				At the currently selected Coordinate (<span class="qunit-image-xCoordinate"></span>,<span class="qunit-image-yCoordinate"></span>) the following colors are found:\n				<table>\n					<thead>\n						<tr>\n							<th></th>\n							<th>actual</th>\n							<th>expected</th>\n						</tr>\n					</thead>\n					<tbody>\n						<tr>\n							<td>R</td>\n							<td class="qunit-image-table-rAct"></td>\n							<td class="qunit-image-table-rExp"></td>\n						</tr>\n						<tr>\n							<td>G</td>\n							<td class="qunit-image-table-gAct"></td>\n							<td class="qunit-image-table-gExp"></td>\n						</tr>\n						<tr>\n							<td>B</td>\n							<td class="qunit-image-table-bAct"></td>\n							<td class="qunit-image-table-bExp"></td>\n						</tr>\n						<tr>\n							<td>A</td>\n							<td class="qunit-image-table-aAct"></td>\n							<td class="qunit-image-table-aExp"></td>\n						</tr>\n						<tr>\n							<td>=</td>\n							<td class="qunit-image-table-act"></td>\n							<td class="qunit-image-table-exp"></td>\n						</tr>\n					</tbody>\n				</table>\n			</div>\n		</div>\n		\n	</div>\n</div>';return __p},function(t){function e(){}function n(){for(var t,n={shadowedProps:P,arrays:"isArray(iterable)",bottom:"",init:"iterable",loop:"",top:"",useHas:!0,useKeys:!!ie},a=0;t=arguments[a];a++)for(var i in t)n[i]=t[i];var r=n.args;n.firstArg=/^[^,]+/.exec(r)[0];var s=Function("hasOwnProperty, isArguments, isArray, keys, lodash, objectTypes","return function("+r+") {\n"+W(n)+"\n}");return s(F,l,ne,ie,e,D)}function a(t){return"\\"+U[t]}function i(t){return re[t]}function r(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}function l(t){return V.call(t)==T}function s(t,n,a,i,u,c){var g=a===b;if("function"==typeof a&&!g){a=e.createCallback(a,i,2);var d=a(t,n);if(d!==m)return!!d}if(t===n)return 0!==t||1/t==1/n;var p=typeof t,_=typeof n;if(t===t&&(!t||"function"!=p&&"object"!=p)&&(!n||"function"!=_&&"object"!=_))return!1;if(null==t||null==n)return t===n;var h=V.call(t),f=V.call(n);if(h==T&&(h=M),f==T&&(f=M),h!=f)return!1;switch(h){case B:case S:return+t==+n;case O:return t!=+t?n!=+n:0==t?1/t==1/n:t==+n;case k:case H:return t==n+""}var y=h==L;if(!y){if(F.call(t,"__wrapped__ ")||F.call(n,"__wrapped__"))return s(t.__wrapped__||t,n.__wrapped__||n,a,i,u,c);if(h!=M||!z.nodeClass&&(r(t)||r(n)))return!1;var v=!z.argsObject&&l(t)?Object:t.constructor,x=!z.argsObject&&l(n)?Object:n.constructor;if(v!=x&&!(o(v)&&v instanceof v&&o(x)&&x instanceof x))return!1}u||(u=[]),c||(c=[]);for(var w=u.length;w--;)if(u[w]==t)return c[w]==n;var q=0;if(d=!0,u.push(t),c.push(n),y){if(w=t.length,q=n.length,d=q==t.length,!d&&!g)return d;for(;q--;){var E=w,C=n[q];if(g)for(;E--&&!(d=s(t[E],C,a,i,u,c)););else if(!(d=s(t[q],C,a,i,u,c)))break}return d}return se(n,function(e,n,r){return F.call(r,n)?(q++,d=F.call(t,n)&&s(t[n],e,a,i,u,c)):m}),d&&!g&&se(t,function(t,e,n){return F.call(n,e)?d=--q>-1:m}),d}function o(t){return"function"==typeof t}function u(t){return t?D[typeof t]:!1}function c(t){for(var e=-1,n=ie(t),a=n.length,i=Array(a);a>++e;)i[e]=t[n[e]];return i}function g(t,e,n){if(null==t)return p;var a=typeof t;if("function"!=a){if("object"!=a)return function(e){return e[t]};var i=ie(t);return function(e){for(var n=i.length,a=!1;n--&&(a=s(e[i[n]],t[i[n]],b)););return a}}return e!==m?1===n?function(n){return t.call(e,n)}:2===n?function(n,a){return t.call(e,n,a)}:4===n?function(n,a,i,r){return t.call(e,n,a,i,r)}:function(n,a,i){return t.call(e,n,a,i)}:t}function d(t){return null==t?"":(t+"").replace(j,i)}function p(t){return t}function _(t,n,i){var r=e.templateSettings;t||(t=""),i=le({},i,r);var l,s=le({},i.imports,r.imports),o=ie(s),u=c(s),g=0,d=i.interpolate||C,p="__p += '",_=RegExp((i.escape||C).source+"|"+d.source+"|"+(d===E?q:C).source+"|"+(i.evaluate||C).source+"|$","g");t.replace(_,function(e,n,i,r,s,o){return i||(i=r),p+=t.slice(g,o).replace(A,a),n&&(p+="' +\n__e("+n+") +\n'"),s&&(l=!0,p+="';\n"+s+";\n__p += '"),i&&(p+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),g=o+e.length,e}),p+="';\n";var h=i.variable,f=h;f||(h="obj",p="with ("+h+") {\n"+p+"\n}\n"),p=(l?p.replace(v,""):p).replace(x,"$1").replace(w,"$1;"),p="function("+h+") {\n"+(f?"":h+" || ("+h+" = {});\n")+"var __t, __p = '', __e = _.escape"+(l?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var y="\n/*\n//@ sourceURL="+(i.sourceURL||"/lodash/template/source["+I++ +"]")+"\n*/";try{var b=Function(o,"return "+p+y).apply(m,u)}catch(j){throw j.source=p,j}return n?b(n):(b.source=p,b)}var m,h="object"==typeof exports&&exports,f="object"==typeof module&&module&&module.exports==h&&module,y="object"==typeof global&&global;(y.global===y||y.window===y)&&(t=y);var b={};+new Date+"";var v=/\b__p \+= '';/g,x=/\b(__p \+=) '' \+/g,w=/(__e\(.*?\)|\b__t\)) \+\n'';/g,q=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,E=/<%=([\s\S]+?)%>/g,C=/($^)/,j=/[&<>"']/g,A=/['\n\r\t\u2028\u2029\\]/g,P=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],I=0,T="[object Arguments]",L="[object Array]",B="[object Boolean]",S="[object Date]",N="[object Function]",O="[object Number]",M="[object Object]",k="[object RegExp]",H="[object String]",D={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},U={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},Q=[],R={};t._;var $=RegExp("^"+(R.valueOf+"").replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),F=(Math.ceil,t.clearTimeout,Q.concat,Math.floor,R.hasOwnProperty),V=(Q.push,t.setTimeout,R.toString),J=$.test(J=V.bind)&&J,X=$.test(X=Array.isArray)&&X,Y=(t.isFinite,t.isNaN,$.test(Y=Object.keys)&&Y);Math.max,Math.min,Math.random,Q.slice;var K=$.test(t.attachEvent),G=J&&!/\n|true/.test(J+K),z=e.support={};(function(){var t=function(){this.x=1},e=[];t.prototype={valueOf:1,y:1};for(var n in new t)e.push(n);for(n in arguments);z.argsObject=arguments.constructor==Object&&!(arguments instanceof Array),z.argsClass=l(arguments),z.enumPrototypes=t.propertyIsEnumerable("prototype"),z.fastBind=J&&!G,z.nonEnumArgs=0!=n,z.nonEnumShadows=!/valueOf/.test(e),z.unindexedChars="xx"!="x"[0]+Object("x")[0];try{z.nodeClass=!(V.call(document)==M&&!({toString:0}+""))}catch(a){z.nodeClass=!0}})(1),e.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:E,variable:"",imports:{_:e}};var W=function(t){var e="var index, iterable = "+t.firstArg+", result = "+t.init+";\nif (!iterable) return result;\n"+t.top+";\n";if(t.arrays?(e+="var length = iterable.length; index = -1;\nif ("+t.arrays+") {  ",z.unindexedChars&&(e+="\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  "),e+="\n  while (++index < length) {\n    "+t.loop+"\n  }\n}\nelse {  "):z.nonEnumArgs&&(e+="\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      "+t.loop+"\n    }\n  } else {  "),z.enumPrototypes&&(e+="\n  var skipProto = typeof iterable == 'function';\n  "),t.useHas&&t.useKeys)e+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] ? keys(iterable) : [],\n      length = ownProps.length;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n    ",z.enumPrototypes&&(e+="if (!(skipProto && index == 'prototype')) {\n  "),e+=t.loop,z.enumPrototypes&&(e+="}\n"),e+="  }  ";else if(e+="\n  for (index in iterable) {",(z.enumPrototypes||t.useHas)&&(e+="\n    if (",z.enumPrototypes&&(e+="!(skipProto && index == 'prototype')"),z.enumPrototypes&&t.useHas&&(e+=" && "),t.useHas&&(e+="hasOwnProperty.call(iterable, index)"),e+=") {    "),e+=t.loop+";    ",(z.enumPrototypes||t.useHas)&&(e+="\n    }"),e+="\n  }    ",z.nonEnumShadows){e+="\n\n  var ctor = iterable.constructor;\n      ";for(var n=0;7>n;n++)e+="\n  index = '"+t.shadowedProps[n]+"';\n  if (","constructor"==t.shadowedProps[n]&&(e+="!(ctor && ctor.prototype === iterable) && "),e+="hasOwnProperty.call(iterable, index)) {\n    "+t.loop+"\n  }      "}return(t.arrays||z.nonEnumArgs)&&(e+="\n}"),e+=t.bottom+";\nreturn result"},Z={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},te={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : lodash.createCallback(callback, thisArg)",arrays:"typeof length == 'number'",loop:"if (callback(iterable[index], index, collection) === false) return result"},ee={top:"if (!objectTypes[typeof iterable]) return result;\n"+te.top,arrays:!1};z.argsClass||(l=function(t){return t?F.call(t,"callee"):!1});var ne=X||function(t){return t?"object"==typeof t&&V.call(t)==L:!1},ae=n({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)",arrays:!1}),ie=Y?function(t){return u(t)?z.enumPrototypes&&"function"==typeof t||z.nonEnumArgs&&t.length&&l(t)?ae(t):Y(t):[]}:ae,re={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},le=n(Z),se=n(te,ee,{useHas:!1}),oe=n(te,ee);o(/x/)&&(o=function(t){return"function"==typeof t&&V.call(t)==N}),e.createCallback=g,e.defaults=le,e.forIn=se,e.forOwn=oe,e.keys=ie,e.values=c,e.escape=d,e.identity=p,e.isArguments=l,e.isArray=ne,e.isEqual=s,e.isFunction=o,e.isObject=u,e.template=_,e.VERSION="1.2.1","function"==typeof define&&"object"==typeof define.amd&&define.amd?(t._=e,define(function(){return e})):h&&!h.nodeType?f?(f.exports=e)._=e:h._=e:t._=e}(this);